# pytest.ini
[pytest]
# -r a  → "report on all tests"
# -q    → quiet output
# -p no:langsmith → disable langsmith plugin to avoid pydantic v1 issues
# --reruns 2 → automatically retry flaky tests up to 2 times
# --reruns-delay 1 → wait 1 second between retries
addopts = -ra -q -p no:langsmith --reruns 2 --reruns-delay 1 --ignore=services/threads_adaptor/tests/unit/test_threads_adaptor.py --ignore=services/achievement_collector/tests/test_achievements.py --ignore=tests/e2e/test_comment_monitor_k8s_resources.py --ignore=tests/e2e/test_comment_monitor_e2e_integration.py --ignore=tests/e2e/test_comment_monitor_chaos_engineering.py

testpaths =
    services
    tests

norecursedirs =
    templates

markers =
    e2e: end-to-end tests that spin k3d (slow)
    flaky: mark test as flaky (will be auto-retried on failure)
    slow: mark test as slow (run with --slow to include)
    unit: unit tests (fast, no external dependencies)
    integration: integration tests (may require services)
    smoke: basic smoke tests for CI
    critical: critical tests that must always pass
